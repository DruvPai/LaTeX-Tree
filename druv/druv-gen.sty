\ProvidesPackage{druv-gen}

%%%%%%%%% PACKAGES
%%%%% PACKAGE ARGUMENTS
%%% TOGGLES
\newtoggle{druv-gen-beamer} \togglefalse{druv-gen-beamer}
\newtoggle{druv-gen-bib} \togglefalse{druv-gen-bib}
\newtoggle{druv-gen-tikz} \togglefalse{druv-gen-tikz}
%%% OPTIONS
\DeclareOption{beamer}{\toggletrue{druv-gen-beamer}}
\DeclareOption{bib}{\toggletrue{druv-gen-bib}}
\DeclareOption{tikz}{\toggletrue{druv-gen-tikz}}
\ProcessOptions

%%%%% AMS CORE PACKAGES
\RequirePackage{amsmath} % https://ctan.org/pkg/amsmath?lang=en
\RequirePackage{amssymb} % https://ctan.org/pkg/amsfonts?lang=en

%%%%% FONT PACKAGES
\RequirePackage{mlmodern} % https://ctan.org/pkg/lm?lang=en
\RequirePackage{mathrsfs} % https://tex.stackexchange.com/questions/532897/what-package-should-i-use-for-mathscrc

%%%%% PGF/TIKZ
\iftoggle{druv-gen-tikz}{
  \RequirePackage{tikz} % https://www.overleaf.com/learn/latex/TikZ_package
  \RequirePackage{pgf}
  \RequirePackage{pgfplots} % https://www.overleaf.com/learn/latex/Pgfplots_package

  \RequirePackage{tikz-cd} % https://ctan.math.washington.edu/tex-archive/graphics/pgf/contrib/tikz-cd/tikz-cd-doc.pdf -- need for quiver diagrams
}{}

%%%%% BIBLIOGRAPHY
\iftoggle{druv-gen-bib}{
  \RequirePackage[style=numeric, citestyle=numeric-comp, backend=biber]{biblatex} % https://www.overleaf.com/learn/latex/Articles/Getting_started_with_BibLaTeX
}{}

%%%%% LAYOUT PACKAGES
%%% TEXT LAYOUT
\RequirePackage{multicol} % https://www.overleaf.com/learn/latex/Multiple_columns
%%% IMAGE LAYOUT
\RequirePackage{float} % https://ctan.org/pkg/float?lang=en
%%% ARRAY/TABULAR LAYOUT
\RequirePackage{array} % https://mirrors.rit.edu/CTAN/macros/latex/required/tools/array.pdf
\RequirePackage{multirow} % https://texblog.org/2012/12/21/multi-column-and-multi-row-cells-in-latex-tables/
\RequirePackage{booktabs} % https://ctan.math.illinois.edu/macros/latex/contrib/booktabs/booktabs.pdf
%%% ENUMERATE LAYOUT
\iftoggle{druv-gen-beamer}{}{
  \RequirePackage[shortlabels]{enumitem} % https://ctan.mirrors.hoobly.com/macros/latex/contrib/enumitem/enumitem.pdf
}

%%%%% MULTIPLE FILES 
\iftoggle{druv-gen-beamer}{}{
  \RequirePackage{subfiles} % https://www.overleaf.com/learn/latex/Multi-file_LaTeX_projects
}

%%%%% REFERENCES
\iftoggle{druv-gen-beamer}{}{
  \RequirePackage[colorlinks=true]{hyperref} % https://mirrors.concertpass.com/tex-archive/macros/latex/contrib/hyperref/doc/hyperref-doc.pdf
  \hypersetup{urlcolor = purple, linkcolor = blue, citecolor = violet}
}
\RequirePackage{cleveref} % http://tug.ctan.org/tex-archive/macros/latex/contrib/cleveref/cleveref.pdf


%%%%%%%%% MACROS
%%%%% DELIMITERS
\RequirePackage{mleftright} % https://tex.stackexchange.com/questions/2607/spacing-around-left-and-right/
%%% FULLY SPACED DELIMITERS
\NewDocumentCommand{\bp}{m}{\left(#1\right)}
\NewDocumentCommand{\bs}{m}{\left[#1\right]}
\NewDocumentCommand{\bc}{m}{\left\{#1\right\}}
\NewDocumentCommand{\ba}{m}{\left\langle#1\right\rangle}
%%% REDUCED-SPACED DELIMITERS
\NewDocumentCommand{\rp}{m}{\mleft(#1\mright)}
\NewDocumentCommand{\rs}{m}{\mleft[#1\mright]}
\NewDocumentCommand{\rc}{m}{\mleft\{#1\mright\}}
\NewDocumentCommand{\ra}{m}{\mleft\langle#1\mright\rangle}

%%%%% OPERATOR FRAMEWORK
\NewDocumentCommand{\opp}{smO{}O{}m}{
  \IfBooleanTF{#1}{ % if used with *, like \operator*{x}
    \operatorname*{#2}_{#3}^{#4}\rp{#5}
  }{
    \operatorname{#2}_{#3}^{#4}\rp{#5}
  }
}

\NewDocumentCommand{\ops}{smO{}O{}m}{
  \IfBooleanTF{#1}{ % if used with *, like \operator*{x}
    \operatorname*{#2}_{#3}^{#4}\rs{#5}
  }{
    \operatorname{#2}_{#3}^{#4}\rs{#5}
  }
}

\NewDocumentCommand{\opc}{smO{}O{}m}{
  \IfBooleanTF{#1}{ % if used with *, like \operator*{x}
    \operatorname*{#2}_{#3}^{#4}\rc{#5}
  }{
    \operatorname{#2}_{#3}^{#5}\rc{#5}
  }
}

%%%%% FONT SHORTHANDS
\NewDocumentCommand{\bA}{}{\mathbb{A}}
\NewDocumentCommand{\bB}{}{\mathbb{B}}
\NewDocumentCommand{\bC}{}{\mathbb{C}}
\NewDocumentCommand{\bD}{}{\mathbb{D}}
\NewDocumentCommand{\bE}{}{\mathbb{E}}
\NewDocumentCommand{\bF}{}{\mathbb{F}}
\NewDocumentCommand{\bG}{}{\mathbb{G}}
\NewDocumentCommand{\bH}{}{\mathbb{H}}
\NewDocumentCommand{\bI}{}{\mathbb{I}}
\NewDocumentCommand{\bJ}{}{\mathbb{J}}
\NewDocumentCommand{\bK}{}{\mathbb{K}}
\NewDocumentCommand{\bL}{}{\mathbb{L}}
\NewDocumentCommand{\bM}{}{\mathbb{M}}
\NewDocumentCommand{\bN}{}{\mathbb{N}}
\NewDocumentCommand{\bO}{}{\mathbb{O}}
\NewDocumentCommand{\bP}{}{\mathbb{P}}
\NewDocumentCommand{\bQ}{}{\mathbb{Q}}
\NewDocumentCommand{\bR}{}{\mathbb{R}}
\NewDocumentCommand{\bS}{}{\mathbb{S}}
\NewDocumentCommand{\bT}{}{\mathbb{T}}
\NewDocumentCommand{\bU}{}{\mathbb{U}}
\NewDocumentCommand{\bV}{}{\mathbb{V}}
\NewDocumentCommand{\bW}{}{\mathbb{W}}
\NewDocumentCommand{\bX}{}{\mathbb{X}}
\NewDocumentCommand{\bY}{}{\mathbb{Y}}
\NewDocumentCommand{\bZ}{}{\mathbb{Z}}
\NewDocumentCommand{\cA}{}{\mathcal{A}}
\NewDocumentCommand{\cB}{}{\mathcal{B}}
\NewDocumentCommand{\cC}{}{\mathcal{C}}
\NewDocumentCommand{\cD}{}{\mathcal{D}}
\NewDocumentCommand{\cE}{}{\mathcal{E}}
\NewDocumentCommand{\cF}{}{\mathcal{F}}
\NewDocumentCommand{\cG}{}{\mathcal{G}}
\NewDocumentCommand{\cH}{}{\mathcal{H}}
\NewDocumentCommand{\cI}{}{\mathcal{I}}
\NewDocumentCommand{\cJ}{}{\mathcal{J}}
\NewDocumentCommand{\cK}{}{\mathcal{K}}
\NewDocumentCommand{\cL}{}{\mathcal{L}}
\NewDocumentCommand{\cM}{}{\mathcal{M}}
\NewDocumentCommand{\cN}{}{\mathcal{N}}
\NewDocumentCommand{\cO}{}{\mathcal{O}}
\NewDocumentCommand{\cP}{}{\mathcal{P}}
\NewDocumentCommand{\cQ}{}{\mathcal{Q}}
\NewDocumentCommand{\cR}{}{\mathcal{R}}
\NewDocumentCommand{\cS}{}{\mathcal{S}}
\NewDocumentCommand{\cT}{}{\mathcal{T}}
\NewDocumentCommand{\cU}{}{\mathcal{U}}
\NewDocumentCommand{\cV}{}{\mathcal{V}}
\NewDocumentCommand{\cW}{}{\mathcal{W}}
\NewDocumentCommand{\cX}{}{\mathcal{X}}
\NewDocumentCommand{\cY}{}{\mathcal{Y}}
\NewDocumentCommand{\cZ}{}{\mathcal{Z}}
\NewDocumentCommand{\sA}{}{\mathscr{A}}
\NewDocumentCommand{\sB}{}{\mathscr{B}}
\NewDocumentCommand{\sC}{}{\mathscr{C}}
\NewDocumentCommand{\sD}{}{\mathscr{D}}
\NewDocumentCommand{\sE}{}{\mathscr{E}}
\NewDocumentCommand{\sF}{}{\mathscr{F}}
\NewDocumentCommand{\sG}{}{\mathscr{G}}
\NewDocumentCommand{\sH}{}{\mathscr{H}}
\NewDocumentCommand{\sI}{}{\mathscr{I}}
\NewDocumentCommand{\sJ}{}{\mathscr{J}}
\NewDocumentCommand{\sK}{}{\mathscr{K}}
\NewDocumentCommand{\sL}{}{\mathscr{L}}
\NewDocumentCommand{\sM}{}{\mathscr{M}}
\NewDocumentCommand{\sN}{}{\mathscr{N}}
\NewDocumentCommand{\sO}{}{\mathscr{O}}
\NewDocumentCommand{\sP}{}{\mathscr{P}}
\NewDocumentCommand{\sQ}{}{\mathscr{Q}}
\NewDocumentCommand{\sR}{}{\mathscr{R}}
\NewDocumentCommand{\sS}{}{\mathscr{S}}
\NewDocumentCommand{\sT}{}{\mathscr{T}}
\NewDocumentCommand{\sU}{}{\mathscr{U}}
\NewDocumentCommand{\sV}{}{\mathscr{V}}
\NewDocumentCommand{\sW}{}{\mathscr{W}}
\NewDocumentCommand{\sX}{}{\mathscr{X}}
\NewDocumentCommand{\sY}{}{\mathscr{Y}}
\NewDocumentCommand{\sZ}{}{\mathscr{Z}}
\NewDocumentCommand{\fA}{}{\mathfrak{A}}
\NewDocumentCommand{\fB}{}{\mathfrak{B}}
\NewDocumentCommand{\fC}{}{\mathfrak{C}}
\NewDocumentCommand{\fD}{}{\mathfrak{D}}
\NewDocumentCommand{\fE}{}{\mathfrak{E}}
\NewDocumentCommand{\fF}{}{\mathfrak{F}}
\NewDocumentCommand{\fG}{}{\mathfrak{G}}
\NewDocumentCommand{\fH}{}{\mathfrak{H}}
\NewDocumentCommand{\fI}{}{\mathfrak{I}}
\NewDocumentCommand{\fJ}{}{\mathfrak{J}}
\NewDocumentCommand{\fK}{}{\mathfrak{K}}
\NewDocumentCommand{\fL}{}{\mathfrak{L}}
\NewDocumentCommand{\fM}{}{\mathfrak{M}}
\NewDocumentCommand{\fN}{}{\mathfrak{N}}
\NewDocumentCommand{\fO}{}{\mathfrak{O}}
\NewDocumentCommand{\fP}{}{\mathfrak{P}}
\NewDocumentCommand{\fQ}{}{\mathfrak{Q}}
\NewDocumentCommand{\fR}{}{\mathfrak{R}}
\NewDocumentCommand{\fS}{}{\mathfrak{S}}
\NewDocumentCommand{\fT}{}{\mathfrak{T}}
\NewDocumentCommand{\fU}{}{\mathfrak{U}}
\NewDocumentCommand{\fV}{}{\mathfrak{V}}
\NewDocumentCommand{\fW}{}{\mathfrak{W}}
\NewDocumentCommand{\fX}{}{\mathfrak{X}}
\NewDocumentCommand{\fY}{}{\mathfrak{Y}}
\NewDocumentCommand{\fZ}{}{\mathfrak{Z}}
\NewDocumentCommand{\fa}{}{\mathfrak{a}}
\NewDocumentCommand{\fb}{}{\mathfrak{b}}
\NewDocumentCommand{\fc}{}{\mathfrak{c}}
\NewDocumentCommand{\fd}{}{\mathfrak{d}}
\NewDocumentCommand{\fe}{}{\mathfrak{e}}
\NewDocumentCommand{\ff}{}{\mathfrak{f}}
\NewDocumentCommand{\fg}{}{\mathfrak{g}}
\NewDocumentCommand{\fh}{}{\mathfrak{h}}
\NewDocumentCommand{\fri}{}{\mathfrak{i}}
\NewDocumentCommand{\fj}{}{\mathfrak{j}}
\NewDocumentCommand{\fk}{}{\mathfrak{k}}
\NewDocumentCommand{\fl}{}{\mathfrak{l}}
\NewDocumentCommand{\fm}{}{\mathfrak{m}}
\NewDocumentCommand{\fn}{}{\mathfrak{n}}
\NewDocumentCommand{\fo}{}{\mathfrak{o}}
\NewDocumentCommand{\fp}{}{\mathfrak{p}}
\NewDocumentCommand{\fq}{}{\mathfrak{q}}
\NewDocumentCommand{\fr}{}{\mathfrak{r}}
\NewDocumentCommand{\fs}{}{\mathfrak{s}}
\NewDocumentCommand{\ft}{}{\mathfrak{t}}
\NewDocumentCommand{\fu}{}{\mathfrak{u}}
\NewDocumentCommand{\fv}{}{\mathfrak{v}}
\NewDocumentCommand{\fw}{}{\mathfrak{w}}
\NewDocumentCommand{\fx}{}{\mathfrak{x}}
\NewDocumentCommand{\fy}{}{\mathfrak{y}}
\NewDocumentCommand{\fz}{}{\mathfrak{z}}

%%%%% COMMON TEXT SHORTHANDS
\NewDocumentCommand{\vocab}{m}{\textbf{#1}}
\NewDocumentCommand{\st}{}{^{\text{st}}}
\NewDocumentCommand{\nd}{}{^{\text{nd}}}
\NewDocumentCommand{\rd}{}{^{\text{rd}}}
\RenewDocumentCommand{\th}{}{^{\text{th}}}

%%%%% COMMON MATH MODE SHORTHANDS
\RequirePackage{centernot} % http://mirrors.ctan.org/macros/latex/contrib/oberdiek/centernot.pdf
\NewDocumentCommand{\ol}{m}{\overline{#1}}
\NewDocumentCommand{\ul}{m}{\underline{#1}}
\NewDocumentCommand{\wt}{m}{\widetilde{#1}}
\NewDocumentCommand{\wh}{m}{\widehat{#1}}
\NewDocumentCommand{\ob}{mm}{\overbrace{#1}^{#2}}
\NewDocumentCommand{\ub}{mm}{\underbrace{#1}_{#2}}
%%% SIGNS WITH UNDER/OVERSET
\NewDocumentCommand{\signlimit}{O{}O{}}{\overset{#2}{\underset{#1}{\longrightarrow}}}
\NewDocumentCommand{\signeq}{O{}O{}}{\overset{#2}{\underset{#1}{=}}}
\NewDocumentCommand{\signequiv}{O{}O{}}{\overset{#2}{\underset{#1}{\equiv}}}
\NewDocumentCommand{\signsim}{O{}O{}}{\overset{#2}{\underset{#1}{\sim}}}
% DEF
\NewDocumentCommand{\defeq}{}{\signeq[][\mathrm{def}]}
\NewDocumentCommand{\defequiv}{}{\signequiv[][\mathrm{def}]}
\NewDocumentCommand{\defsim}{}{\signsim[][\mathrm{def}]}
% SET
\NewDocumentCommand{\seteq}{}{\signeq[][\mathrm{set}]}
\NewDocumentCommand{\setequiv}{}{\signequiv[][\mathrm{set}]}
\NewDocumentCommand{\setsim}{}{\signsim[][\mathrm{set}]}

%%%%% COMMON EQUATION SHORTHANDS
\NewDocumentCommand{\casework}{m}{\begin{cases}#1\end{cases}}
\NewDocumentCommand{\numberthis}{}{\addtocounter{equation}{1}\tag{\theequation}} % used when we have unnumbered equation*/align* and want to give a number to a particular line.
\NewDocumentCommand{\qq}{m}{\quad\text{#1}\quad}
\NewDocumentCommand{\qm}{m}{\quad\ensuremath{#1}\quad}
\NewDocumentCommand{\qc}{}{, \quad}
\NewDocumentCommand{\qqq}{m}{\qquad\text{#1}\qquad}
\NewDocumentCommand{\qqm}{m}{\qquad\ensuremath{#1}\qquad}
\NewDocumentCommand{\qqc}{}{, \qquad}

%%%%% TRIGONOMETRY
\RenewDocumentCommand{\sin}{m}{\opp{sin}{#1}}
\RenewDocumentCommand{\cos}{m}{\opp{cos}{#1}}
\RenewDocumentCommand{\tan}{m}{\opp{tan}{#1}}
\RenewDocumentCommand{\csc}{m}{\opp{csc}{#1}}
\RenewDocumentCommand{\sec}{m}{\opp{sec}{#1}}
\RenewDocumentCommand{\cot}{m}{\opp{cot}{#1}}
\RenewDocumentCommand{\sinh}{m}{\opp{sinh}{#1}}
\RenewDocumentCommand{\cosh}{m}{\opp{cosh}{#1}}
\RenewDocumentCommand{\tanh}{m}{\opp{tanh}{#1}}
\NewDocumentCommand{\csch}{m}{\opp{csch}{#1}}
\NewDocumentCommand{\sech}{m}{\opp{sech}{#1}}
\RenewDocumentCommand{\coth}{m}{\opp{coth}{#1}}
\RenewDocumentCommand{\arcsin}{m}{\opp{sin}[][-1]{#1}}
\RenewDocumentCommand{\arccos}{m}{\opp{cos}[][-1]{#1}}
\RenewDocumentCommand{\arctan}{m}{\opp{tan}[][-1]{#1}}
\NewDocumentCommand{\arccsc}{m}{\opp{csc}[][-1]{#1}}
\NewDocumentCommand{\arcsec}{m}{\opp{sec}[][-1]{#1}}
\NewDocumentCommand{\arccot}{m}{\opp{cot}[][-1]{#1}}
\NewDocumentCommand{\arcsinh}{m}{\opp{sinh}[][-1]{#1}}
\NewDocumentCommand{\arccosh}{m}{\opp{cosh}[][-1]{#1}}
\NewDocumentCommand{\arctanh}{m}{\opp{tanh}[][-1]{#1}}
\NewDocumentCommand{\arccsch}{m}{\opp{csch}[][-1]{#1}}
\NewDocumentCommand{\arcsech}{m}{\opp{sech}[][-1]{#1}}
\NewDocumentCommand{\arccoth}{m}{\opp{coth}[][-1]{#1}}

%%%%% REAL ANALYSIS
\RequirePackage{derivative} % http://mirrors.ctan.org/macros/latex/contrib/derivative/derivative.pdf
\RequirePackage{esint} % https://ctan.math.illinois.edu/macros/latex/contrib/esint/esint-doc.pdf
\RequirePackage{interval} % https://ctan.math.illinois.edu/macros/latex/contrib/interval/interval.pdf
\intervalconfig{soft open fences} % for open intervals, use () instead of ][
\xpatchcmd{\interval}{interval,}{interval,scaled,}{}{} % auto-scales intervals
\NewDocumentCommand{\eps}{}{\varepsilon}
\NewDocumentCommand{\abs}{m}{\left|#1\right|}
\NewDocumentCommand{\norm}{m}{\left\Vert#1\right\Vert}
\NewDocumentCommand{\ip}{mm}{\ba{#1, #2}}
\NewDocumentCommand{\ipip}{m}{\ba{#1, #1}} % Repeats the first argument in e.g. Hilbert spaces as a replacement for norm.
\NewDocumentCommand{\eval}{m}{\left.#1\right|}
\NewDocumentCommand{\dist}{O{}m}{\opp{dist}[#1]{#2}}
% ALMOST EVERYWHERE
\RenewDocumentCommand{\ae}{O{}}{
  \IfEq{#1}{}{
    \mathrm{a.e.}
  }{
    #1\mathrm{-a.e.}
  }
}
\NewDocumentCommand{\aelimit}{O{}O{}}{\signlimit[#1][\ae[#2]]}
\NewDocumentCommand{\aelim}{O{}O{}}{\lim_{#1}^{\ae[#2]}} % in case we want to use traditional limit notation
\NewDocumentCommand{\aeeq}{O{}}{\signeq[][\ae[#1]]}
\NewDocumentCommand{\aeequiv}{O{}}{\signequiv[][\ae[#1]]}
\NewDocumentCommand{\aesim}{O{}}{\signsim[][\ae[#1]]}
% ``IN MEASURE''
\NewDocumentCommand{\measure}{}{\mathrm{meas.}}
\NewDocumentCommand{\measurelimit}{O{}O{\measure}}{\signlimit[#1][#2]}
\NewDocumentCommand{\measurelim}{O{}O{\measure}}{\lim_{#1}^{#2}}
\NewDocumentCommand{\measureeq}{O{\measure}}{\signeq[][#1]}
\NewDocumentCommand{\measureequiv}{O{\measure}}{\signequiv[][#1]}
\NewDocumentCommand{\measuresim}{O{\measure}}{\signsim[][#1]}
% ``IN DISTRIBUTION''
\NewDocumentCommand{\distribution}{}{\mathrm{dist.}}
\NewDocumentCommand{\dlimit}{O{}}{\signlimit[#1][\distribution]}
\NewDocumentCommand{\dlim}{O{}}{\lim_{#1}^{\distribution}}
\NewDocumentCommand{\deq}{}{\signeq[][\distribution]}
\NewDocumentCommand{\dequiv}{}{\signequiv[][\distribution]}
\NewDocumentCommand{\dsim}{}{\signsim[][\distribution]}
% WEAK
\NewDocumentCommand{\weak}{}{\mathrm{weak}}
\NewDocumentCommand{\wlimit}{O{}}{\signlimit[#1][\weak]}
\NewDocumentCommand{\wlim}{O{}}{\lim_{#1}^{\weak}}
\NewDocumentCommand{\weq}{}{\signeq[][\weak]}
\NewDocumentCommand{\wequiv}{}{\signequiv[][\weak]}
\NewDocumentCommand{\wsim}{}{\signsim[][\weak]}

%%%%% COMPLEX ANALYSIS
\NewDocumentCommand{\e}{}{\mathrm{e}}
\RenewDocumentCommand{\i}{}{\mathrm{i}}
\RenewDocumentCommand{\Re}{m}{\opp{Re}{#1}}
\RenewDocumentCommand{\Im}{m}{\opp{Im}{#1}}
\RenewDocumentCommand{\exp}{m}{\opp{exp}{#1}}
\RenewDocumentCommand{\log}{O{}m}{\opp{log}[#1]{#2}}
\NewDocumentCommand{\res}{O{}m}{\opp{Res}[#1]{#2}}

%%%%% DISCRETE MATH, COMBINATORICS, AND ALGORITHMS
%%% DISCRETE MATH
\DeclareMathOperator*{\argmin}{arg min}
\DeclareMathOperator*{\argmax}{arg max}
\NewDocumentCommand{\floor}{m}{\left\lfloor#1\right\rfloor}
\NewDocumentCommand{\ceiling}{m}{\left\lceil#1\right\rceil}
\RenewDocumentCommand{\gcd}{m}{\opp{gcd}{#1}}
\NewDocumentCommand{\lcm}{m}{\opp{lcm}{#1}}
%%% COMBINATORICS
\RenewDocumentCommand{\deg}{O{}m}{\opp{deg}[#1]{#2}}
\NewDocumentCommand{\area}{O{}m}{\opp{area}[#1]{#2}}
\NewDocumentCommand{\volume}{O{}m}{\opp{volume}[#1]{#2}}
\NewDocumentCommand{\sign}{m}{\opp{sign}{#1}}
%%% PROGRAMMING
\RequirePackage{minted} % https://www.overleaf.com/learn/latex/Code_Highlighting_with_minted
%%% ALGORITHMS
\RequirePackage{algpseudocodex} % http://mirrors.ctan.org/macros/latex/contrib/algpseudocodex/documentation.pdf -- remember to use minipage to get correct indent
\algrenewcommand\algorithmicrequire{\textbf{Input:}} % Remaps \Require to Input`
\algrenewcommand\algorithmicensure{\textbf{Output:}} % Remaps \Ensure to Output
\NewDocumentCommand{\p}{}{\textsf{P}}
\NewDocumentCommand{\np}{}{\textsf{NP}}
\NewDocumentCommand{\bqp}{}{\textsf{BQP}}
\NewDocumentCommand{\opt}{}{\textsf{OPT}}
\NewDocumentCommand{\tm}{}{\textsf{TM}}

%%%%% ABSTRACT ALGEBRA
\NewDocumentCommand{\ord}{m}{\opp{ord}{#1}}
\NewDocumentCommand{\Hom}{m}{\opp{Hom}{#1}}
\NewDocumentCommand{\Endo}{m}{\opp{End}{#1}}
\NewDocumentCommand{\Gal}{m}{\opp{Gal}{#1}}
\NewDocumentCommand{\Spec}{m}{\opp{Spec}{#1}}

%%%%% LINEAR ALGEBRA
\RequirePackage{bm} % http://mirrors.ctan.org/macros/latex/required/tools/bm.pdf
%%% COMPUTATIONAL LINEAR ALGEBRA
\NewDocumentCommand{\mat}{m}{\begin{bmatrix}#1\end{bmatrix}}
\NewDocumentCommand{\tr}{m}{\opp{tr}{#1}}
\RenewDocumentCommand{\det}{m}{\opp{det}{#1}}
\NewDocumentCommand{\proj}{mm}{\opp*{proj}[#2]{#1}}
\NewDocumentCommand{\diag}{m}{\opp{diag}{#1}}
\NewDocumentCommand{\Col}{m}{\opp{Col}{#1}}
\NewDocumentCommand{\Null}{m}{\opp{Null}{#1}}
%%% ABSTRACT LINEAR ALGEBRA
\NewDocumentCommand{\Ker}{m}{\opp{Ker}{#1}}
\RenewDocumentCommand{\Im}{m}{\opp{Im}{#1}}
\NewDocumentCommand{\Span}{m}{\opp{Span}{#1}}
\RenewDocumentCommand{\dim}{m}{\opp{dim}{#1}}
\NewDocumentCommand{\codim}{m}{\opp{codim}{#1}}
\NewDocumentCommand{\rank}{m}{\opp{rank}{#1}}
%%% LINEAR ALGEBRAIC SPACES
\NewDocumentCommand{\GL}{m}{\opp{GL}{#1}}
\NewDocumentCommand{\SL}{m}{\opp{SL}{#1}}
\RenewDocumentCommand{\O}{m}{\opp{O}{#1}}
\NewDocumentCommand{\SO}{m}{\opp{SO}{#1}}
\NewDocumentCommand{\U}{m}{\opp{U}{#1}}
\NewDocumentCommand{\SU}{m}{\opp{SU}{#1}}
\NewDocumentCommand{\Sym}{m}{\opp{Sym}{#1}}
\NewDocumentCommand{\Herm}{m}{\opp{Herm}{#1}}
\NewDocumentCommand{\PSD}{m}{\opp{PSD}{#1}}
\NewDocumentCommand{\PD}{m}{\opp{PD}{#1}}

%%%%% TOPOLOGY
\NewDocumentCommand{\id}{}{\operatorname{id}}
\NewDocumentCommand{\Cl}{O{}m}{\opp{Cl}[#1]{#2}}
\NewDocumentCommand{\Int}{O{}m}{\opp{Int}[#1]{#2}}
\NewDocumentCommand{\Ext}{O{}m}{\opp{Ext}[#1]{#2}}
\NewDocumentCommand{\Bd}{O{}m}{\opp{Bd}[#1]{#2}}

%%%%% PROBABILITY
%%% BASIC QUANTITIES
\NewDocumentCommand{\possiblyconditioned}{mO{}O{}mO{}} {
  \IfEq{#5}{}{
    \opp{#1}[#2][#3]{#4}
  }{
    \opp{#1}[#2][#3]{#4 \; \middle| \; #5}
  }
}
\RenewDocumentCommand{\Pr}{O{}O{}mO{}}{\possiblyconditioned{\mathbf{P}}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\Ex}{O{}O{}mO{}}{\possiblyconditioned{\mathbf{E}}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\Cov}{O{}O{}mO{}}{\possiblyconditioned{Cov}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\Var}{O{}O{}mO{}}{\possiblyconditioned{Var}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\Corr}{O{}O{}mO{}}{\possiblyconditioned{Corr}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\indvar}{m}{1_{#1}}
\NewDocumentCommand{\iid}{}{\mathrm{i.i.d.}}
\NewDocumentCommand{\ind}{}{\perp \!\!\! \perp}
\NewDocumentCommand{\simiid}{}{\signsim[][\iid]}
\NewDocumentCommand{\simind}{}{\signsim[][\ind]}
% ALMOST SURELY
\NewDocumentCommand{\as}{O{}}{
  \IfEq{#1}{}{
    \mathrm{a.s.}
  }{
    #1\mathrm{-a.s.}
  }
}
\NewDocumentCommand{\aslimit}{O{}O{}}{\signlimit[#1][\as[#2]]}
\NewDocumentCommand{\aslim}{O{}O{}}{\lim_{#1}^{\as[#2]}}
\NewDocumentCommand{\aseq}{O{}}{\signeq[][\as[#1]]}
\NewDocumentCommand{\asequiv}{O{}}{\signequiv[][\as[#1]]}
\NewDocumentCommand{\assim}{O{}}{\signsim[][\as[#1]]}
% ``IN PROBABILITY''
\NewDocumentCommand{\plimit}{O{}O{\mathrm{prob.}}}{\signlimit[#1][#2]}
\NewDocumentCommand{\plim}{O{}O{\mathrm{prob.}}}{\lim_{#1}^{#2}}
\NewDocumentCommand{\peq}{O{\mathrm{prob.}}}{\signeq[][#1]}
\NewDocumentCommand{\pequiv}{O{\mathrm{prob.}}}{\signequiv[][#1]}
\NewDocumentCommand{\psim}{O{\mathrm{prob.}}}{\signsim[][#1]}
%%% PROBABILITY DISTRIBUTIONS
% DISCRETE DISTRIBUTIONS
\NewDocumentCommand{\dBern}{m}{\opp{Bernoulli}{#1}}
\NewDocumentCommand{\dBin}{m}{\opp{B}{#1}}
\NewDocumentCommand{\dGeo}{m}{\opp{Geo}{#1}}
\NewDocumentCommand{\dUnif}{m}{\opp{\(\cU\)}{#1}}
\NewDocumentCommand{\dPois}{m}{\opp{Pois}{#1}}
% CONTINUOUS DISTRIBUTIONS
\NewDocumentCommand{\dNorm}{m}{\opp{\(\cN\)}{#1}}
\NewDocumentCommand{\dExp}{m}{\opp{Exp}{#1}}
\NewDocumentCommand{\dErl}{m}{\opp{Erlang}{#1}}
\NewDocumentCommand{\dGamma}{m}{\opp{Gamma}{#1}}
\NewDocumentCommand{\dBeta}{m}{\opp{Beta}{#1}}

%%%%% STATISTICS
\NewDocumentCommand{\RSS}{O{}O{}mO{}}{\possiblyconditioned{RSS}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\PRSS}{O{}O{}mO{}}{\possiblyconditioned{PRSS}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\EPE}{O{}O{}mO{}}{\possiblyconditioned{EPE}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\DF}{O{}O{}mO{}}{\possiblyconditioned{DF}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\MSE}{O{}O{}mO{}}{\possiblyconditioned{MSE}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\LLSE}{O{}O{}mO{}}{\possiblyconditioned{LLSE}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\MMSE}{O{}O{}mO{}}{\possiblyconditioned{MMSE}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\Bias}{O{}O{}mO{}}{\possiblyconditioned{Bias}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\MLE}{O{}O{}mO{}}{\possiblyconditioned{MLE}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\MAP}{O{}O{}mO{}}{\possiblyconditioned{MAP}[#1][#2]{#3}[#4]}
\NewDocumentCommand{\softmax}{O{}m}{\opp{softmax}[#1]{#2}}
