\ProvidesPackage{druv-pkg}

\newif\ifdruvdiagram\druvdiagramfalse
\newif\ifdruvbib\druvbibfalse
\newif\ifdruvchem\druvchemfalse
\DeclareOption{diagram}{\druvdiagramtrue}
\DeclareOption{bib}{\druvbibtrue}
\DeclareOption{chem}{\druvchemtrue}
\ProcessOptions\relax

%%% PACKAGES AND MACROS %%%
% Essentials
% AMS Stuff
\usepackage{amsmath,amssymb, amsthm}
% For theorems!
\usepackage{thmtools}
% For colors!
\usepackage[usenames, svgnames, dvipsnames, table, xcdraw]{xcolor}
% Essential images and graphs
\usepackage{tikz}
\ifdruvdiagram
    \usepackage{pgf}
    \usepackage{pgfplots}
\fi
% Fonts
\newcommand\hmmax{0}
\newcommand\bmmax{0}
\usepackage[T1]{fontenc}
%\usepackage[lcgreekalpha, upint]{stix} \usepackage[defaultsans, scale=0.95]{lato} % default
%\usepackage{lmodern} \usepackage{mathrsfs} \usepackage[defaultsans, scale=0.95]{lato}
%\usepackage[varg]{txfonts} \usepackage[defaultsans, scale=0.95]{lato}
%\usepackage{pxfonts} \usepackage[defaultsans, scale=0.95]{lato}
%\usepackage{lmodern} \usepackage[lite]{mtpro2} \usepackage[defaultsans, scale=0.95]{lato}
%\usepackage{lmodern} \usepackage{newtxtext} \usepackage[defaultsans, scale=0.95]{lato}
\usepackage{newtxtext} \usepackage{newtxmath} \usepackage{mathrsfs} \usepackage{helvet}
%\usepackage{newtxtext} \usepackage[lite]{mtpro2} \usepackage{helvet}
%\usepackage{lmodern} \usepackage{newtxtext} \usepackage[defaultsans, scale=0.95]{lato}
%\usepackage{mathpazo} \usepackage{mathrsfs} \usepackage[defaultsans, scale=0.95]{lato}
% More theorems!
\usepackage[framemethod=TikZ]{mdframed}
% Little optimizations and QoL stuff
\usepackage{mathtools}
\usepackage[Symbol]{upgreek}
\usepackage[colorlinks=true]{hyperref}
\usepackage[capitalize]{cleveref}
\usepackage{booktabs}
\usepackage{import}
\usepackage{calc}
\usepackage{verbatim}
\usepackage{overpic}
\usepackage{float}
\usepackage{bm}
\@ifundefined{KOMAClassName}{}{
    \usepackage{subfiles}
    \usepackage{ifthen}
    \usepackage{etoolbox}
    \usepackage{xstring}
    \usepackage{xpatch}
}
\usepackage{caption}
\usepackage{centernot}
\usepackage{csquotes}
\ifdruvbib
    \usepackage[style=mla,backend=biber]{biblatex}
\fi
% Auxiliary Packages
% Multiple columns in ToC (Comes later)
\usepackage{multicol}
\@ifundefined{KOMAClassName}{}{
    \usepackage{paracol}
}
% Scientific typesetting
\usepackage{array}
\usepackage{siunitx}
\usepackage{physics}
\usepackage{esint}
\ifdruvchem
    \usepackage{chemgreek}
    \usepackage{chemmacros}
    \usepackage{chemfig}
    \usepackage{lewis}
    \usepackage{chemformula}
    \usepackage{ghsystem}
\fi
% More optimizations!
\usepackage{listings}
%\usepackage{mathrsfs}
\usepackage{textcomp}
\usepackage[shortlabels]{enumitem}
\usepackage[noend]{algpseudocode}
\@ifundefined{chapter}{\usepackage[ruled, section]{algorithm}}{\usepackage[ruled,chapter]{algorithm}}
\usepackage[obeyFinal,textsize=scriptsize,shadow]{todonotes}
\usepackage{microtype}
% Page Setup
\usepackage{geometry}
\usepackage{wrapfig}
\@ifundefined{KOMAClassName}{}{
    \usepackage{titling}
    \usepackage[headsepline]{scrlayer-scrpage}
}

% PACKAGE SETUP
\@ifundefined{KOMAClassName}{}{
% Multicolumn TOCs
\renewcommand\tableofcontents{%
    \begin{multicols}{2}[\section*{\contentsname
        \@mkboth{%
           \MakeUppercase\contentsname}{\MakeUppercase\contentsname}}]%
    \@starttoc{toc}%
    \end{multicols}%
    }
\setlength{\columnsep}{2cm}
\setcounter{tocdepth}{1} % part, chapter and section
%\setcounter{tocdepth}{0} % part and chapter
%\setcounter{tocdepth}{-1} % part
}

% SIUnitX
\sisetup{
add-decimal-zero = false,
add-integer-zero = false,
%per-mode=fraction
}
\DeclareSIUnit\year{y}
\DeclareSIUnit\lightspeed{c}
\DeclareSIUnit\lightyear{ly}
\DeclareSIUnit\dyne{dyn}
\DeclareSIUnit\ergon{erg}
\DeclareSIUnit\revolution{rev}
\DeclareSIUnit\gauss{G}
\DeclareSIUnit\lb{lb}
\DeclareSIUnit\atom{atom}
\DeclareSIUnit\molecule{molecule}
\DeclareSIUnit\radian{rad}

% Chemistry
\ifdruvchem
    \chemsetup{modules=all}
    \chemsetup[reactions] {tag-open = (, tag-close = )}
    \newcommand{\staten}[1]{\state[superscript-right=]{#1}}
    \newcommand{\conc}[1]{[\ch{#1}]}
    % we put these here since it's not easy to pass options to macro package
\fi

% Random Listings Formatting
\lstset{basicstyle=\normalsize\ttfamily,
numbers=left,
numbersep=5pt,
numberstyle=\tiny,
keywordstyle=\bfseries,
showstringspaces=false,
tabsize=4,
frame=single,
keywordstyle=\bfseries\color{blue},
commentstyle=\color{green!70!black},
identifierstyle=\color{green!20!black},
stringstyle=\color{orange},
breaklines=true,
breakatwhitespace=true,
xleftmargin=10pt,
aboveskip=-10pt,
belowskip=0pt
}

% Diagram package configurations
\ifdruvdiagram
    \pgfplotsset{compat=1.8}
    \usetikzlibrary{arrows, calc, graphs, graphs.standard, matrix, positioning, shapes, trees, decorations.pathmorphing}
    \usepackage{tikz-3dplot, tikz-cd, tkz-berge, tkz-graph, forest}
    \usepackage[siunitx, american, cuteinductors, smartlabels, betterproportions]{circuitikz}
    \tikzcdset{row sep/normal=3.14em,column sep/normal=3.14em}
    \usepgfplotslibrary{fillbetween}
    \pgfplotsset{ticks=none}
\fi


% Hyperref
\hypersetup{urlcolor=Purple,linkcolor=RoyalBlue,citecolor=Purple}
